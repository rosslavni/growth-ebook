自动化部署
---

优化我们开发流程有一个很重要的步骤就是：让部署自动化。通过部署自动化，我们可以大大缩减我们的开发周期，加快软件交付流程。下图是一个自动化部署的流程图：

![自动化部署](chapters/chapter4/auto-deployment.png)

从下图中我们可以得到下面的五个步骤：

 - 获取源码
 - 获取依赖
 - 构建软件包
 - 生成/上传安装包
 - 目标平台安装/配置

这个过程可能和之前的Web项目构建过程差不多，然而却多了好几步。

在前面的章节里，我们已经使用了版本管理系统来管理我们的源码。因此，在这里对于获取源码的介绍就比较简单了——我们只需要在我们的CI（持续集成）服务器上使用``git clone``这一类的方法来获取我们的源码即可。

##依赖与包仓库

获取完源码后，我们就需要开始下载软件包依赖。无论是Python、Ruby、Java，还是JavaScript都需要这样的一个过程。软件开发已经从大教堂式的开发走向了集市——开源软件改变了这一切。

![大教堂与集市](chapters/chapter4/hierarchy-vs-graph.png)

过去我们需要大系统的内部构建我们使用的依赖，现在我们更多地借助于外部的库来实现这些功能。这也意味着，如果在这一个节点里出现了意外——软件被删除，那么这个系统将陷入瘫痪的状态。如之前在NPM圈发生了“一个 17 行的模块引发的血案”——即left-pad 工具模块被作者从NPM上撤下，所有直接或者间接依赖这个模块的NPM的软件包都挂掉了。因为我们依赖于公有的包服务，所以系统便严重依赖于外部条件。

这时候一种简单、有效的方案就是搭建自己的包服务。如使用Java技术栈的项目，就会使用Nexus搭建自己的Maven私有服务。我们的软件依赖包将会依赖于我们自己的服务，此时会产生的主要问题可能就是：我们的软件包不是最新的。但是对于追求稳定的项目来说，这个并不是必须的需求，反而这也是一个优势。

###构建软件包

![RPM Build Process](chapters/chapter4/rpm-deploy.jpg)

###生成、上传安装包

###目标平台安装/配置

