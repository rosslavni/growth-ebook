网站性能优化
---

针对网站性能优化领域，网上已经有相当多的总结，这里只罗列一些常见（我用过）的策略。

###减少HTTP请求

从网上查找的情况分类来看，有下面的一些情况：

 - 合并JavaScript和CSS。只是这种方式需要好好评估，因为合并过多的JavaScript，可能会导致JavaScript文件过大。一个大的文件将增加Load时间，导致不好的用户体验。
 - CSS Sprites。即将一个页面涉及到的所有零星图片都包含到一张大图中去。值得注意的是，像Logo这一类文件将不要加到里面去了。
 - 拆分初始化负载。将页面加载时需要的一堆JavaScript文件，分成两部分：渲染页面所必需的和其他的。页面初始化时，只加载必须的，其余的等会加载。
 - 划分主域。将资源划分的请求划分到几个不同的域上，来加速资源请求。

对于我这样的懒人来说，我使用Google出品的PageSpeed。它主要的功能是针对前端页面而进行服务器端的优化，对前端设计人员来说，可以省去优化css、js以及图片的过程。它可以对CSS和JavaScript压缩、合并、级联、内联，生成一个新的Script和CSS文件 。还有图像优化：剥离元数据、动态调整，重新压缩，如针对Chrome浏览器生成WebP文件。还可以推迟图像和JavaScript加载。

###页面内部优化

HTML页面内的优化的目的便是：**尽快渲染出页面**。常见的优化策略便是：

 - 将CSS放在顶部，即早点渲染出页面及其样式。
 - 将JavaScript放在底部。如果有后台渲染机制，那么就应该将JS放到页面底部来加速页面加载。如果是单页面应用，那么这个JS就应该在页面顶部。
 - 压缩HTML。在我们写模板的过程中，一些判断可能会导致页面有过多的空格。压缩这些HTML，可以稍微提高一下页面速度。

这里的大部分内容都应该通过修改代码来完成。

###启用缓存

前面的缓存一节里，我们说过了一些缓存的策略，我们再稍微提一下。

 - 后台优化，如数据库端缓存
 - 启用页面缓存，即应用层缓存

###减少下载量

简单地来说，就是减少对服务器的请求：

 - 使用 CDN
 - 使用外部 JavaScript 和 CSS
 - 缓存：使用 gzip 压缩、添加 Expires 头、配置 ETag、使 AjaX 可缓存

###网络连接上的优化

主要就是对域名到服务器进行优化，因此从方法上有：

 - DNS 域名解析加速
 - 减少 DNS 查找
